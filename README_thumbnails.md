# 照片画廊缩略图功能说明

## 功能概述

为了提高浏览页面的性能，系统现在支持自动生成缩略图功能：
- **浏览页面**：使用缩略图，加载速度快
- **单图浏览**：点击图片后显示原图，保证图片质量

## 安装依赖

首先需要安装Python图片处理库：

```bash
pip install -r requirements.txt
```

或者直接安装：

```bash
pip install Pillow
```

## 使用方法

### 1. 为现有照片生成缩略图

运行以下命令为现有的所有照片生成缩略图：

```bash
python generate_thumbnails.py
```

这个脚本会：
- 扫描 `data/` 文件夹中的所有图片
- 在 `thumbnails/` 文件夹中生成对应的缩略图
- 缩略图尺寸：最大400x300像素，保持宽高比
- 自动跳过已存在的缩略图

### 2. 上传新照片

上传新照片时，系统会自动：
- 保存原图到 `data/` 文件夹
- 生成缩略图到 `thumbnails/` 文件夹
- 在JSON数据中添加缩略图路径

### 3. 浏览体验

- **照片网格页面**：自动使用缩略图，加载速度快
- **灯箱查看**：点击图片后显示原图，保证最佳观看体验
- **响应式设计**：缩略图在不同设备上都能良好显示

## 文件结构

```
PhotoGallery/
├── data/           # 原图存储
├── thumbnails/     # 缩略图存储
├── photos.json     # 照片数据（包含缩略图路径）
├── server.py       # 服务器（支持缩略图生成）
├── generate_thumbnails.py  # 缩略图生成脚本
└── requirements.txt # Python依赖
```

## 技术特点

- **智能缩放**：保持图片宽高比，不会变形
- **质量优化**：缩略图使用高质量算法生成
- **格式支持**：支持JPG、PNG、BMP、TIFF、WebP等格式
- **自动回退**：如果缩略图生成失败，自动使用原图
- **性能提升**：大幅减少页面加载时间和带宽使用

## 注意事项

1. 确保有足够的磁盘空间存储缩略图
2. 首次运行缩略图生成脚本可能需要一些时间
3. 如果修改了原图，需要重新生成对应的缩略图
4. 建议定期清理不再使用的缩略图文件

## 故障排除

### 缩略图生成失败
- 检查Pillow库是否正确安装
- 确认图片文件格式是否支持
- 查看错误日志获取详细信息

### 缩略图不显示
- 检查 `thumbnails/` 文件夹是否存在
- 确认缩略图文件权限是否正确
- 刷新浏览器缓存

### 性能问题
- 确保缩略图尺寸设置合理
- 检查图片文件大小是否过大
- 考虑使用CDN或图片压缩服务
